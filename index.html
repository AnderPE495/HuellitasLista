<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel de Control Huellitas</title>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; }
  .container { margin-top: 20px; }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  th { background-color: #f2f2f2; } p#total-caja {font-size: 40px; margin:0px; font-weight:700}
</style>
</head>
<body>
  <header>
    <h1>Panel de Control Huellitas</h1>
  </header>
  <h2>Añadir Alumno</h2>
  <form id="form-venta">
    <input type="text" id="Nombre" placeholder="Nombre" required />
    <input type="number" id="dni" placeholder="dni" required />
        <input type="text" id="descripcion" placeholder="Descripción" required />
    <button type="submit">Añadir Alumno</button>
  </form>

  </div>
  <div class="container">
    <h2>Ingredientes</h2>
    <table id="ingredientes-table">
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Costo</th>
      </tr>
      <!-- Los ingredientes se cargarán aquí -->
    </table>

    <h2>Ventas</h2>
    <table id="ventas-table">
      <tr>
        <th>ID</th>
        <th>Producto</th>
        <th>Precio</th>
        <th>Fecha</th>
      </tr>
      <!-- Las ventas se cargarán aquí -->
    </table>

    <h2>Gastos</h2>
    <table id="gastos-table">
      <tr>
        <th>ID</th>
        <th>Descripción</th>
        <th>Monto</th>
        <th>Fecha</th>
      </tr>
      <!-- Los gastos se cargarán aquí -->
    </table>



<script>
// Función para cargar y mostrar los datos en la tabla
async function cargarDatos() {
  // Cargar ingredientes
  const ingredientes = await fetch('/ingredientes').then(res => res.json());
  const ingredientesTable = document.getElementById('ingredientes-table');
  ingredientes.forEach(ing => {
    ingredientesTable.innerHTML += `<tr><td>${ing.id}</td><td>${ing.nombre}</td><td>S/${ing.costo}</td></tr>`;
  });

  // Cargar ventas
  const ventas = await fetch('/ventas').then(res => res.json());
  const ventasTable = document.getElementById('ventas-table');
  ventas.forEach(venta => {
    ventasTable.innerHTML += `<tr><td>${venta.id}</td><td>${venta.producto}</td><td>S/${venta.precio}</td><td>${venta.fecha}</td></tr>`;
  });

  // Cargar gastos
  const gastos = await fetch('/gastos').then(res => res.json());
  const gastosTable = document.getElementById('gastos-table');
  gastos.forEach(gasto => {
    gastosTable.innerHTML += `<tr><td>${gasto.id}</td><td>${gasto.descripcion}</td><td>S/${gasto.monto}</td><td>${gasto.fecha}</td></tr>`;
  });

  // Calcular total en caja
  const totalVentas = ventas.reduce((total, venta) => total + venta.precio, 0);
  const totalGastos = gastos.reduce((total, gasto) => total + gasto.monto, 0);
  const totalCaja = totalVentas - totalGastos;
  document.getElementById('total-caja').textContent = `S/${totalCaja.toFixed(2)}`;
}

// Función para añadir una venta
document.getElementById('form-venta').onsubmit = async function(event) {
  event.preventDefault();
  const producto = document.getElementById('producto').value;
  const precio = parseFloat(document.getElementById('precio').value);
  const fecha = document.getElementById('fecha-venta').value;
  const respuesta = await fetch('/ventas', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ producto, precio, fecha })
  });
  if (respuesta.ok) {
    window.location.reload(); // Recargar la página para actualizar la lista
  }
};

// Función para añadir un gasto
document.getElementById('form-gasto').onsubmit = async function(event) {
  event.preventDefault();
  const descripcion = document.getElementById('descripcion').value;
  const monto = parseFloat(document.getElementById('monto').value);
  const fecha = document.getElementById('fecha-gasto').value;
  const respuesta = await fetch('/gastos', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ descripcion, monto, fecha })
  });
  if (respuesta.ok) {
    window.location.reload(); // Recargar la página para actualizar la lista
  }
};

// Llamar a cargarDatos cuando la ventana se cargue
window.onload = cargarDatos;
</script>
</body>
</html>
